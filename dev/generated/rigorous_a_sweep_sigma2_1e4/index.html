<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>a Sweep · SelfConsistentLogisticNoise.jl</title><meta name="title" content="a Sweep · SelfConsistentLogisticNoise.jl"/><meta property="og:title" content="a Sweep · SelfConsistentLogisticNoise.jl"/><meta property="twitter:title" content="a Sweep · SelfConsistentLogisticNoise.jl"/><meta name="description" content="Documentation for SelfConsistentLogisticNoise.jl."/><meta property="og:description" content="Documentation for SelfConsistentLogisticNoise.jl."/><meta property="twitter:description" content="Documentation for SelfConsistentLogisticNoise.jl."/><meta property="og:url" content="https://orkolorko.github.io/SelfConsistentLogisticNoise.jl/generated/rigorous_a_sweep_sigma2_1e4/"/><meta property="twitter:url" content="https://orkolorko.github.io/SelfConsistentLogisticNoise.jl/generated/rigorous_a_sweep_sigma2_1e4/"/><link rel="canonical" href="https://orkolorko.github.io/SelfConsistentLogisticNoise.jl/generated/rigorous_a_sweep_sigma2_1e4/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SelfConsistentLogisticNoise.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../theory/">Mathematical Background</a></li><li><a class="tocitem" href="../../api/">API Reference</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../rigorous_delta_sweep/">Delta Sweep</a></li><li><a class="tocitem" href="../rigorous_noise_variance_sweep/">Noise Variance Sweep</a></li><li class="is-active"><a class="tocitem" href>a Sweep</a><ul class="internal"><li><a class="tocitem" href="#Configuration"><span>Configuration</span></a></li><li><a class="tocitem" href="#Helper"><span>Helper</span></a></li><li><a class="tocitem" href="#Sweep-and-Plot"><span>Sweep and Plot</span></a></li><li><a class="tocitem" href="#Comparison-Plot-(selected-a)"><span>Comparison Plot (selected a)</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>a Sweep</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>a Sweep</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/orkolorko/SelfConsistentLogisticNoise.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/orkolorko/SelfConsistentLogisticNoise.jl/blob/main/docs/src/generated/rigorous_a_sweep_sigma2_1e4.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Rigorous-a-Sweep-at-Fixed-Noise-Variance-(σ-1e-4)"><a class="docs-heading-anchor" href="#Rigorous-a-Sweep-at-Fixed-Noise-Variance-(σ-1e-4)">Rigorous a-Sweep at Fixed Noise Variance (σ² = 1e-4)</a><a id="Rigorous-a-Sweep-at-Fixed-Noise-Variance-(σ-1e-4)-1"></a><a class="docs-heading-anchor-permalink" href="#Rigorous-a-Sweep-at-Fixed-Noise-Variance-(σ-1e-4)" title="Permalink"></a></h1><p>This tutorial sweeps the quadratic map parameter a in [0.9, 1.0] at fixed noise variance σ² = 1e-4 and coupling δ = 0. We only retain fixed points whose rigorous L2 error bound is below a target threshold. If certification fails, we retry with larger N.</p><pre><code class="language-julia hljs">using SelfConsistentLogisticNoise
using Plots
using Printf

include(joinpath(@__DIR__, &quot;cert_log.jl&quot;))</code></pre><h2 id="Configuration"><a class="docs-heading-anchor" href="#Configuration">Configuration</a><a id="Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration" title="Permalink"></a></h2><pre><code class="language-julia hljs">σ2 = 1e-4
σ = sqrt(σ2)
δ = 0.0
N_candidates = [128, 192, 256, 384, 512, 768, 1024]
η = 0.0025
σ_sm = 0.0075
use_taper = false
M_override = 1024
τ_CAP = 0.1
write_markdown_summary = true
write_latex_summary = true

a_range = 0.9:0.001:1.0
error_threshold = 0.1

npts = 1000
output_dir = joinpath(&quot;docs&quot;, &quot;literate&quot;, &quot;rigorous_a_sweep_sigma2_1e4_png&quot;)
mkpath(output_dir)
log_path = joinpath(output_dir, &quot;certification_log.md&quot;)
jld2_path = joinpath(output_dir, &quot;certification_output.jld2&quot;)
latex_path = joinpath(output_dir, &quot;certification_summary_a_sweep.tex&quot;)

config = Dict(
    :script =&gt; &quot;rigorous_a_sweep_sigma2_1e4&quot;,
    :σ2 =&gt; σ2,
    :σ =&gt; σ,
    :δ =&gt; δ,
    :N_candidates =&gt; N_candidates,
    :η =&gt; η,
    :σ_sm =&gt; σ_sm,
    :use_taper =&gt; use_taper,
    :M_override =&gt; M_override,
    :τ_CAP =&gt; τ_CAP,
    :a_range =&gt; collect(a_range),
    :error_threshold =&gt; error_threshold,
    :npts =&gt; npts,
    :log_path =&gt; log_path,
    :jld2_path =&gt; jld2_path,
)

println(&quot;=&quot;^70)
println(&quot;RIGOROUS a-SWEEP (σ² = 1e-4, δ = 0)&quot;)
println(&quot;=&quot;^70)
println(&quot;σ² = $σ2, σ = $σ, δ = $δ, τ = $τ_CAP&quot;)
println(&quot;η = $η (taper width)&quot;)
println(&quot;σ_sm = $σ_sm (smoothing width)&quot;)
println(&quot;taper = $use_taper, M = $M_override&quot;)
println(&quot;a range = $(first(a_range)) to $(last(a_range)) (step = $(step(a_range)))&quot;)
println(&quot;N candidates = $(N_candidates)&quot;)
println(&quot;L2 error threshold = $error_threshold&quot;)</code></pre><h2 id="Helper"><a class="docs-heading-anchor" href="#Helper">Helper</a><a id="Helper-1"></a><a class="docs-heading-anchor-permalink" href="#Helper" title="Permalink"></a></h2><pre><code class="language-julia hljs">function compute_verified_density(prob::SCProblem, fhat::Vector{ComplexF64})
    cap = verify_fixed_point_CAP(prob, fhat; τ=τ_CAP, verbose=false)
    if cap.verified &amp;&amp; cap.total_error &lt;= error_threshold
        xgrid, fvals = reconstruct_density(fhat; npts=npts)
        return (xgrid=xgrid, fvals=fvals, cap=cap), cap
    end
    return nothing, cap
end</code></pre><h2 id="Sweep-and-Plot"><a class="docs-heading-anchor" href="#Sweep-and-Plot">Sweep and Plot</a><a id="Sweep-and-Plot-1"></a><a class="docs-heading-anchor-permalink" href="#Sweep-and-Plot" title="Permalink"></a></h2><pre><code class="language-julia hljs">println(&quot;\nRunning sweep...&quot;)
verified = Dict{Float64, NamedTuple}()
records = Dict{Float64, NamedTuple}()
for a in a_range
    @printf(&quot;\na = %.2f\n&quot;, a)
    verified_entry = nothing
    cap = nothing
    used_N = nothing
    for N in N_candidates
        @printf(&quot;  trying N = %d\n&quot;, N)
        prob = build_problem(
            a=a, σ=σ, N=N, δ=δ, coupling_type=:linear,
            η=η, σ_sm=σ_sm, taper=use_taper, M_override=M_override, cache=false
        )
        result = solve_hybrid(prob; α=0.3, picard_tol=1e-6, newton_tol=1e-14, verbose=false)

        if !result.converged
            println(&quot;    solver did not converge; continuing&quot;)
            continue
        end

        verified_entry, cap = compute_verified_density(prob, result.fhat)
        if verified_entry !== nothing
            used_N = N
            break
        end
        println(&quot;    not verified or error too large: total_error = $(cap.total_error)&quot;)
    end

    if verified_entry === nothing
        println(&quot;  no certified result for this a&quot;)
        records[a] = (
            verified=false,
            used_N=used_N,
            total_error=cap === nothing ? nothing : cap.total_error,
            cap=cap,
            xgrid=nothing,
            fvals=nothing,
        )
        continue
    end

    @printf(&quot;  verified at N = %d: total_error = %.6e\n&quot;, used_N, cap.total_error)
    verified[a] = verified_entry
    records[a] = (
        verified=true,
        used_N=used_N,
        total_error=cap === nothing ? nothing : cap.total_error,
        cap=cap,
        xgrid=verified_entry.xgrid,
        fvals=verified_entry.fvals,
    )

    p = plot(
        verified_entry.xgrid,
        verified_entry.fvals;
        label=false,
        lw=2,
        title=@sprintf(&quot;a = %.2f (σ² = %.1e, N = %d)&quot;, a, σ2, used_N),
        xlabel=&quot;x&quot;,
        ylabel=&quot;f(x)&quot;,
        size=(800, 400),
    )
    savefig(p, joinpath(output_dir, @sprintf(&quot;density_a_%0.2f_N_%d.png&quot;, a, used_N)))
    display(p)
end</code></pre><h2 id="Comparison-Plot-(selected-a)"><a class="docs-heading-anchor" href="#Comparison-Plot-(selected-a)">Comparison Plot (selected a)</a><a id="Comparison-Plot-(selected-a)-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-Plot-(selected-a)" title="Permalink"></a></h2><pre><code class="language-julia hljs">selected = collect(range(0.9, 0.99; length=10))
p_compare = plot(
    title=&quot;Verified stationary densities (selected a)&quot;,
    xlabel=&quot;x&quot;,
    ylabel=&quot;f(x)&quot;,
    size=(900, 500),
)

for a in selected
    entry = get(verified, a, nothing)
    if entry === nothing
        @printf(&quot;  skipping a = %.2f (not verified or not computed)\n&quot;, a)
        continue
    end
    cap = entry.cap
    plot!(
        p_compare,
        entry.xgrid,
        entry.fvals;
        label=@sprintf(&quot;a = %.2f (≤ %.1e)&quot;, a, cap.total_error),
        lw=2,
    )
end

savefig(p_compare, joinpath(output_dir, &quot;density_comparison_selected.png&quot;))
display(p_compare)

if write_markdown_summary
    write_cert_log(
        log_path;
        title=&quot;a-sweep certification log (σ² = 1e-4)&quot;,
        key_label=&quot;a&quot;,
        key_format=a -&gt; @sprintf(&quot;%.3f&quot;, a),
        config=config,
        records=records,
    )
end
save_state_jld2(jld2_path, config, verified, records)

if write_latex_summary
    write_latex_summary(
        latex_path;
        title=&quot;a-sweep summary (\\$\\sigma^2=10^{-4}\\$)&quot;,
        key_label=&quot;\\\$a\\\$&quot;,
        key_values=collect(range(0.9, 0.99; length=10)),
        key_format=a -&gt; @sprintf(&quot;%.3f&quot;, a),
        records=records,
        fig_path=joinpath(&quot;docs&quot;, &quot;literate&quot;, &quot;rigorous_a_sweep_sigma2_1e4_png&quot;, &quot;density_comparison_selected.png&quot;),
        fig_caption=&quot;Verified stationary densities for selected \\$a\\$ values.&quot;,
        fig_label=&quot;a_sweep&quot;,
    )
end</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../rigorous_noise_variance_sweep/">« Noise Variance Sweep</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 22 January 2026 02:08">Thursday 22 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
